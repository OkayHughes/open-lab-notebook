<!DOCTYPE html>
<html lang="en">
  <head>
    
    
    
    <meta charset="utf-8" />
    <link rel="icon" href="https://cdn.glitch.com/8af1b7af-efae-4a35-b1d7-e47b835582bc%2Fall_TMQ_moist_day5-1.ico?v=1630525741731" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Your new 11ty blog" />
    <link rel="stylesheet" type="text/css" href="/open-lab-notebook/public/style.css"/>
    <link rel="stylesheet" type="text/css" href="/open-lab-notebook/public/fonts/cmu.css"/>
 
    <link rel="stylesheet" href="https://unpkg.com/katex@latest/dist/katex.min.css" />
    
    <title>Open Lab Notebook</title>

<meta name="description" content="A blog which serves as my lab notebook, but which is visible to the world because I&apos;m a masochist.">
<meta name="robots" content="index,follow">
<meta name="author" content="undefined">

<link rel="canonical" href="https://undefined.glitch.me/posts/DA_HOMME/optimizing_imex/">

<meta property="og:title" content="Open Lab Notebook">
<meta property="og:type" content="article">

<meta property="og:url" content="https://undefined.glitch.me/posts/DA_HOMME/optimizing_imex/">
<meta property="og:description" content="A blog which serves as my lab notebook, but which is visible to the world because I&apos;m a masochist.">
<meta property="og:image" content="https://cdn.glitch.com/8af1b7af-efae-4a35-b1d7-e47b835582bc%2Fall_TMQ_moist_day5.png?v=1630525127233">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://undefined.glitch.me/posts/DA_HOMME/optimizing_imex/">
<meta name="twitter:title" content="Open Lab Notebook">
<meta name="twitter:description" content="A blog which serves as my lab notebook, but which is visible to the world because I&apos;m a masochist.">
<meta name="twitter:image" content="https://cdn.glitch.com/8af1b7af-efae-4a35-b1d7-e47b835582bc%2Fall_TMQ_moist_day5.png?v=1630525127233">


  </head>
  <body>
  <main>
    
    
  
    


<div class="wrapper post">
  <div>
    
    <h1 class='postTitle'>Optimizing IMEX convergence</h1>

    
    
    
    <p>In the first phase of this work, we compare SA HOMME and DA HOMME with the numerical Jacobian
to remove the analytic Jacobian math in DA HOMME as a source of error.</p>
<p>For the Matsuno-gill heating pattern (20 levels, full-size earth, 10km model top), time steps
at the two-day mark converge in 6 iterations in DA HOMME but 3 iterations in SA HOMME.
Both models are using their respective numerical jacobian routines.</p>
<p>This indicates that the form of the analytic Jacobian is not the source of our problems.</p>
<p>Next steps:</p>
<ul>
<li>Ensure that there is no mis-treatment of upper boundary condition in DA HOMME numerical Jacobian code</li>
<li>Test sensitivity to initial guess.</li>
<li>Identify tuning parameters for convergence and test sensitivity.</li>
</ul>
<h2>Checking if rest of imex routines are broken:</h2>
<p>Hypothesis: treatment of Fn (residual) does not include QHE terms?
Experiment: disable QHE terms in explicit. Is convergence better?</p>
<ul>
<li>If extra terms of QHE are omitted, numerical Jacobian converges in 3 iterations past day 10!</li>
<li>Do addition of QHE change acoustic mode?</li>
</ul>
<p>Todo:</p>
<ul>
<li>
<p>Verify numerical Jacobian is stable to 20 days with &quot;hydrostatic&quot; initial guess</p>
<ul>
<li>10 days: 4 iterations.</li>
<li>Potential offshoot project: is quasi-hydrostatic guess better?</li>
</ul>
</li>
<li>
<p>Verify analytic Jacobian is dogshit at 20 days without &quot;hydrostatic&quot; initial guess</p>
<ul>
<li>With better initial guess: 5 iterations at 20 days.</li>
<li>With explicit w initial guess: 10 iterations at 5 days</li>
</ul>
</li>
<li>
<p>Contingent on this: analyze |J_analytic - J_numerical| test residual by level.</p>
<ul>
<li>Order of magnitude is independent of level :(</li>
</ul>
</li>
<li>
<p>If it's bad at boundaries, life's good. If not, rework analytic Jacobian.</p>
</li>
</ul>
<p>Todo: rework jacobian lmao</p>

    <div class="controls">

    
      
          <h3>
            Parent post:
      </h3>
          <ul><li><a href="/open-lab-notebook/posts/DA_HOMME/">Deep Atmosphere HOMME</a></li></ul>
      
      
      
      
      
    </div>
  </div>
</div>


      <footer class="footer">
        <div class="links">
          <a href="/">Home</a>
          <span class="divider">|</span>
          <a href="/posts">Posts</a>
          <span class="divider">|</span>
          <a href="/about">About</a>
        </div>
        <a class="btn--remix" target="_top" href="https://glitch.com/edit/#!/remix/glitch-hello-eleventy">
        <img src="https://cdn.glitch.com/605e2a51-d45f-4d87-a285-9410ad350515%2FLogo_Color.svg?v=1618199565140" alt="" /> 
        Remix on Glitch
        </a>
        <a class="btn--remix" target="_top" href="https://glitch.com/edit/#!/open-lab-notebook">
        Edit
        </a>
      </footer>
    
  </main>
   
  </body>
</html>
