<!DOCTYPE html>
<html lang="en">
  <head>
    
    
    
    <meta charset="utf-8" />
    <link rel="icon" href="https://cdn.glitch.com/8af1b7af-efae-4a35-b1d7-e47b835582bc%2Fall_TMQ_moist_day5-1.ico?v=1630525741731" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Your new 11ty blog" />
    <link rel="stylesheet" type="text/css" href="public/style.css" />
    <link rel="stylesheet" type="text/css" href="public/fonts/cmu.css" />
    <link rel="stylesheet" href="https://unpkg.com/katex@latest/dist/katex.min.css" />
    
    <title>Open Lab Notebook</title>

<meta name="description" content="A blog which serves as my lab notebook, but which is visible to the world because I&apos;m a masochist.">
<meta name="robots" content="index,follow">
<meta name="author" content="undefined">

<link rel="canonical" href="https://undefined.glitch.me/posts/E3SM/E3SM_2.0_greatlakes/">

<meta property="og:title" content="Open Lab Notebook">
<meta property="og:type" content="article">

<meta property="og:url" content="https://undefined.glitch.me/posts/E3SM/E3SM_2.0_greatlakes/">
<meta property="og:description" content="A blog which serves as my lab notebook, but which is visible to the world because I&apos;m a masochist.">
<meta property="og:image" content="https://cdn.glitch.com/8af1b7af-efae-4a35-b1d7-e47b835582bc%2Fall_TMQ_moist_day5.png?v=1630525127233">

<meta name="twitter:card" content="summary">

<meta name="twitter:url" content="https://undefined.glitch.me/posts/E3SM/E3SM_2.0_greatlakes/">
<meta name="twitter:title" content="Open Lab Notebook">
<meta name="twitter:description" content="A blog which serves as my lab notebook, but which is visible to the world because I&apos;m a masochist.">
<meta name="twitter:image" content="https://cdn.glitch.com/8af1b7af-efae-4a35-b1d7-e47b835582bc%2Fall_TMQ_moist_day5.png?v=1630525127233">


  </head>
  <body>
  <main>
    
    
  
    


<div class="wrapper post">
  <div>
    
    <h1 class='postTitle'>Installing E3SM 2.0 on Greatlakes using my jank MPAS dependencies</h1>

    
    
    
    <p>Follow the installation notes from <a href="https://github.com/jhollowed/e3sm_greatlakes_install">Joe's excellent README</a>.</p>
<p>In order to proceed you will need to either 1) follow the installation instructions <a href="https://open-lab-notebook.glitch.me/posts/installing-mpas/">here</a> or 2) obtain
the dependencies from me (if you're on greatlakes, check <code>/nfs/turbo/cjablono2/owhughes/dependencies.tar.gz</code>)</p>
<h3>Reducing your <code>~/.cime</code> config files to a soup-like homogenate.</h3>
<p>Change the files in your <code>~/.cime</code> directory as follows:</p>
<details>
<summary> ~/.cime/bash.source</summary>
<pre><code># from CJ CESM install instructions:
# https://docs.google.com/document/d/1VHEWx3Isxs7csE2tv1bxtTvBkUIVU_LK_jocxjxy1Tw/edit?usp=sharing

module load gcc/8.2.0
module load cmake/3.17.3

  
  
# Change these to suit your installation!
# ====================================================
# for E3SM
INPUT_NAME=inputData 
export MY_E3SM_ROOT=${PATH_TO_E3SM}/CLDERA-E3SM
export DIN_LOC_ROOT=${MY_E3SM_ROOT}/${INPUT_NAME}
export MY_E3SM_CASES=${PATH_TO_CASES}
export MY_SLURM_ACCOUNT=cjablono1
export MY_E3SM_SCRATCH=${PATH_TO_E3SM_SCRATCH}

# for jank dependencies
export DEPENDENCIES=&quot;${scratch}/dependencies&quot;
# ====================================================


export PATH=${DEPENDENCIES}/mpich/bin:$PATH
export NETCDF_C_PATH=${DEPENDENCIES}/netcdf_c
export NETCDF_F_PATH=${DEPENDENCIES}/netcdf_fortran
export NETCDF_CPP_PATH=${DEPENDENCIES}/netcdf_cpp 
export PNETCDF_PATH=${DEPENDENCIES}/pnetcdf
export HDF5_PATH=${DEPENDENCIES}/hdf5
export ZLIB_PATH=${DEPENDENCIES}/zlib
export LD_LIBRARY_PATH=&quot;${PNETCDF_PATH}/lib:${NETCDF_C_PATH}/lib:${HDF5_PATH}/lib:${NETCDF_CPP_PATH}/lib:${NETCDF_F_PATH}/lib:${LD_LIBRARY_PATH}&quot;

</code></pre>
</details>
<p>Likewise use the following <a href="https://open-lab-notebook.glitch.me/posts/E3SM/config_machines/">~/.cime/config_machines.xml</a>, <a href="https://open-lab-notebook.glitch.me/posts/E3SM/config_compilers/">~/.cime/config_compilers.xml</a>.
Note: the <code>config_machines.xml</code> depends on environment variables set in <code>~/.cime/bash.source</code>, so make sure
to run <code>source ${HOME}/.cime/bash.source</code> before trying to create cases.</p>
<h3>Creating the case:</h3>
<p>Make sure to edit the lines</p>
<pre><code>readonly CODE_ROOT=&quot;/home/owhughes/E3SM/CLDERA-E3SM&quot;
readonly CASE_ROOT=&quot;/scratch/cjablono_root/cjablono1/owhughes/E3SM/E3SMv2/${CASE_NAME}&quot;
</code></pre>
<p>Do <code>cd ~/e3sm_greatlakes_install</code></p>
<p>Do <code>bash run_e3sm.template.greatlakes.sh</code>. It should run correctly and fail in the first timestep.
An error indicates that the tracer advection scheme <code>slmm_csl</code> is failing because the remapping timestep
<code>dt_remap</code> may be too large (one of the <code>sl</code> means &quot;semilagrangian&quot;, hence the need to remap to a fixed grid).</p>

    <div class="controls">

    
      
          <h3>
            Parent post:
      </h3>
          <ul><li><a href="/open-lab-notebook/posts/E3SM/">E3SM</a></li></ul>
      
      
      
          <h3>
            Descendent posts:
          </h3>
          <ul><li><a href="/open-lab-notebook/posts/E3SM/config_compilers/">config_compilers.xml</a></li>
<li><a href="/open-lab-notebook/posts/E3SM/config_machines/">config_machines.xml</a></li></ul>

      
      
      
    </div>
  </div>
</div>

      <footer class="footer">
        <div class="links">
          <a href="/">Home</a>
          <span class="divider">|</span>
          <a href="/posts">Posts</a>
          <span class="divider">|</span>
          <a href="/about">About</a>
        </div>
        <a class="btn--remix" target="_top" href="https://glitch.com/edit/#!/remix/glitch-hello-eleventy">
        <img src="https://cdn.glitch.com/605e2a51-d45f-4d87-a285-9410ad350515%2FLogo_Color.svg?v=1618199565140" alt="" /> 
        Remix on Glitch
        </a>
        <a class="btn--remix" target="_top" href="https://glitch.com/edit/#!/open-lab-notebook">
        Edit
        </a>
      </footer>
    
  </main>
   
  </body>
</html>
